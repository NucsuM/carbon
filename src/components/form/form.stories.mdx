
import { Meta, Story, Preview, Props } from '@storybook/addon-docs/blocks';
import { useState } from 'react';

import Form from '.';
import Textbox from '../../__experimental__/components/textbox';
import Button from '../button';
import DialogFullScreen from '../dialog-full-screen';
import Dialog from '../dialog';

<Meta
  title="Design System/Form"
  parameters={{ info: { disable: true }}}
/>

# Form
Represents a document section containing interactive controls for submitting information.

## Quick Start

To use Form, import the `Form` and pass the content, usually various inputs, as children.

You can provide a save button using the `saveButton` prop.


```jsx
import Form from "carbon-react/lib/components/form"

const MyComponent = () => (
  <Form
    onSubmit={ handleSubmit }
    leftSideButtons={ <Button onClick={ handleCancel }>Cancel</Button> }
    saveButton={ <Button buttonType='primary' type="submit">Save</Button> }
  >
    <Textbox label="Label1" />
    <Textbox label="Label2" />
  </Form>
);
```

## Visuals

### With sticky footer
When `stickyFooter` prop is set as true, footer becomes stickied to the bottom of the screen when necessary - this also works in `Dialog` and `DialogFullScreen`

<Preview>
  <Story name="Basic with sticky footer">
    <Form
      onSubmit={ () => console.log('submit')}
      leftSideButtons={ <Button onClick={ () => console.log('cancel') }>Cancel</Button> }
      saveButton={ <Button buttonType='primary' type="submit">Save</Button> }
      stickyFooter
    >
      <Textbox label="Textbox" />
      <Textbox label="Textbox" />
      <Textbox label="Textbox" />
      <Textbox label="Textbox" />
      <Textbox label="Textbox" />
      <Textbox label="Textbox" />
      <Textbox label="Textbox" />
    </Form>
  </Story> 
</Preview>

### With different spacing
When `fieldSpacingMultiplier` prop is given a value, the vertical spacing between the form fields is changed (margin bottom on each field), the value of the prop multiplied by the base theme `8px` spacing value. The default is value `3` which is therefore `24px`. This can be overriden on a specific field if needed.

<Preview>
  <Story name="With different spacing">
    <Form
      onSubmit={ () => console.log('submit')}
      leftSideButtons={ <Button onClick={ () => console.log('cancel') }>Cancel</Button> }
      saveButton={ <Button buttonType='primary' type="submit">Save</Button> }
      fieldSpacingMultiplier={5}
    >
      <Textbox label="Textbox" />
      <Textbox label="Textbox" />
      <Textbox label="Textbox" />
      <Textbox label="Textbox" />
    </Form>
  </Story> 
</Preview>

### Override spacing on one field
A child component (which uses `FormField`) can be given a `marginBottom` prop which overrides the bottom margin for that particular field. This uses the same base theme `8px` multiplier as the Form `fieldSpacingMultiplier` prop. 

<Preview>
  <Story name="Override field spacing">
    <Form
      onSubmit={ () => console.log('submit')}
      leftSideButtons={ <Button onClick={ () => console.log('cancel') }>Cancel</Button> }
      saveButton={ <Button buttonType='primary' type="submit">Save</Button> }
    >
      <Textbox label="Textbox" />
      <Textbox label="Textbox" />
      <Textbox label="Textbox" marginBottom={7} />
      <Textbox label="Textbox" />
    </Form>
  </Story> 
</Preview>

### Validations
When either `errorCount` or `warningCount` or both are provided, summary with the number of errors and/or warnings is rendered wrapping the save button.

<Preview>
  <Story name="With errors summary">
    <Form
      onSubmit={ () => console.log('submit')}
      leftSideButtons={ <Button onClick={ () => console.log('cancel') }>Cancel</Button> }
      saveButton={ <Button buttonType='primary' type="submit">Save</Button> }
      errorCount={ 1 }
    >
      <Textbox label="Textbox" />
    </Form>
  </Story> 
</Preview>

<Preview>
  <Story name="With warnings summary">
    <Form
      onSubmit={ () => console.log('submit')}
      leftSideButtons={ <Button onClick={ () => console.log('cancel') }>Cancel</Button> }
      saveButton={ <Button buttonType='primary' type="submit">Save</Button> }
      warningCount={ 1 }
    >
      <Textbox label="Textbox" />
    </Form>
  </Story> 
</Preview>

<Preview>
  <Story name="With both errors and warnings summary">
    <Form
      onSubmit={ () => console.log('submit')}
      leftSideButtons={ <Button onClick={ () => console.log('cancel') }>Cancel</Button> }
      saveButton={ <Button buttonType='primary' type="submit">Save</Button> }
      errorCount={ 2 }
      warningCount={ 2 }
    >
      <Textbox label="Textbox" />
    </Form>
  </Story> 
</Preview>

### Buttons variations
Additional buttons can be passed using `leftSideButtons` and `rightSideButtons` props.

<Preview>
  <Story name="With additional buttons">
    <Form
      onSubmit={ () => console.log('submit')}
      leftSideButtons={ 
        <>
          <Button onClick={ () => console.log('cancel') }>Other</Button>
          <Button onClick={ () => console.log('cancel') }>Cancel</Button>
        </> 
      }
      saveButton={ <Button buttonType='primary' type="submit">Save</Button> }
      rightSideButtons={ 
        <>
          <Button onClick={ () => console.log('cancel') }>Reset</Button>
          <Button onClick={ () => console.log('cancel') }>Other</Button>
        </> 
      }
    >
      <Textbox label="Textbox" />
    </Form>
  </Story> 
</Preview>

When `buttonAlignment` prop is set as `left`, buttons are aligned to the left side.

<Preview>
  <Story name="With buttons aligned to the left">
    <Form
      onSubmit={ () => console.log('submit')}
       leftSideButtons={ 
        <>
          <Button onClick={ () => console.log('cancel') }>Other</Button>
          <Button onClick={ () => console.log('cancel') }>Cancel</Button>
        </> 
      }
      saveButton={ <Button buttonType='primary' type="submit">Save</Button> }
      rightSideButtons={ 
        <>
          <Button onClick={ () => console.log('cancel') }>Reset</Button>
          <Button onClick={ () => console.log('cancel') }>Other</Button>
        </> 
      }
      buttonAlignment='left'
    >
      <Textbox label="Textbox" />
    </Form>
  </Story> 
</Preview>

### In Dialog
It is possible to render `Form` as a content of `Dialog` component.

<Preview>
  <Story name="In Dialog">
    {() => {
      const [isOpen, setIsOpen] = useState(false);
      return (
        <>
          <Button onClick={ () => setIsOpen(true) }>Open Preview</Button>
          <Dialog
            open={ isOpen }
            onCancel={ () => setIsOpen(false) }
            title='Form in Dialog'
            subtitle='Subtitle'
          >
            <Form
              leftSideButtons={ <Button onClick={ () => setIsOpen(false) }>Cancel</Button> }
              saveButton={ <Button buttonType='primary' onClick={ () => console.log('save') }>Submit</Button> }
            >
              <Textbox label='Textbox' />
            </Form>
          </Dialog>
        </>
      );
    }}
  </Story>
</Preview>

With sticky footer

<Preview>
  <Story name="In Dialog with sticky footer">
    {() => {
      const [isOpen, setIsOpen] = useState(false);
      return (
        <>
          <Button onClick={ () => setIsOpen(true) }>Open Preview</Button>
          <Dialog
            open={ isOpen }
            onCancel={ () => setIsOpen(false) }
            title='Form in Dialog'
            subtitle='Subtitle'
          >
            <Form
              leftSideButtons={ <Button onClick={ () => setIsOpen(false) }>Cancel</Button> }
              saveButton={ <Button buttonType='primary' onClick={ () => console.log('save') }>Submit</Button> }
              stickyFooter
            >
              {Array.from({ length: 15 }).map((_, index) => <Textbox key={ index } label='Textbox' />)}
            </Form>
          </Dialog>
        </>
      );
    }}
  </Story>
</Preview>

### In DialogFullScreen
It is possible to render `Form` as a content of `DialogFullScreen` component.

<Preview>
  <Story name="In DialogFullScreen">
    {() => {
      const [isOpen, setIsOpen] = useState(false);
      return (
        <>
          <Button onClick={ () => setIsOpen(true) }>Open Preview</Button>
          <DialogFullScreen
            open={ isOpen }
            onCancel={ () => setIsOpen(false) }
            title='Form in Dialog'
            subtitle='Subtitle'
          >
            <Form
              leftSideButtons={ <Button onClick={ () => setIsOpen(false) }>Cancel</Button> }
              saveButton={ <Button buttonType='primary' onClick={ () => console.log('save') }>Submit</Button> }
            >
              <Textbox label='Textbox' />
            </Form>
          </DialogFullScreen>
        </>
      );
    }}
  </Story>
</Preview>


With sticky footer

<Preview>
  <Story name="In DialogFullScreen with sticky footer">
    {() => {
      const [isOpen, setIsOpen] = useState(false);
      return (
        <>
          <Button onClick={ () => setIsOpen(true) }>Open Preview</Button>
          <DialogFullScreen
            open={ isOpen }
            onCancel={ () => setIsOpen(false) }
            title='Form in Dialog'
            subtitle='Subtitle'
          >
            <Form
              leftSideButtons={ <Button onClick={ () => setIsOpen(false) }>Cancel</Button> }
              saveButton={ <Button buttonType='primary' onClick={ () => console.log('save') }>Submit</Button> }
              stickyFooter
            >
              {Array.from({ length: 15 }).map((_, index) => <Textbox key={ index } label='Textbox' />)}
            </Form>
          </DialogFullScreen>
        </>
      );
    }}
  </Story>
</Preview>

## Props

<Props of={Form} />